if(!String.contains){String.prototype.contains=function(a){return this.indexOf(a)!==-1}}Element.prototype.addClass=function(a){if(this.classList){this.classList.add(a)}else{if(!this.hasClass(a)){this.className+=" "+a}}};Element.prototype.removeClass=function(a){if(this.classList){this.classList.remove(a)}else{this.className=this.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")}};Element.prototype.toggleClass=function(c){if(this.classList){this.classList.toggle(c)}else{var b=this.className.split(" ");var a=b.indexOf(c);if(a>=0){b.splice(a,1)}else{b.push(c)}this.className=b.join(" ")}};Element.prototype.hasClass=function(a){if(this.classList){return this.classList.contains(a)}else{return(new RegExp("(^| )"+a+"( |$)","gi")).test(this.className)}};Element.prototype.hasChild=function(b){if(this.hasChildNodes()){for(var a=0;a<this.childNodes.length;a++){if(this.childNodes[a]===b){return true}}}return false};var MySingleSelect=function(a){this.referredSelect=a;this.referredSelect.options=this.referredSelect.querySelectorAll("option");this.create()};MySingleSelect.prototype={structure:null,selectedElement:null,create:function(){var e;var d;var a;this.structure=document.createElement("div");this.structure.addClass("myFormSelect");e=document.createElement("span");e.innerHTML="Seleziona un'opzione";e.addEventListener("click",this.openSelect.bind(this));this.structure.appendChild(e);d=document.createElement("ul");this.structure.appendChild(d);var b=this.referredSelect.querySelectorAll("option");for(var c=0;c<b.length;c++){a=document.createElement("li");a.innerHTML=b[c].innerHTML;d.appendChild(a);a.addEventListener("click",this.optionSelected.bind(this))}document.addEventListener("click",this.closeSelect.bind(this))},openSelect:function(a){this.structure.toggleClass("showOptions")},closeSelect:function(a){if(a.target!==this.structure&&!this.structure.contains(a.target)){this.structure.removeClass("showOptions")}},optionSelected:function(b){if(!this.selectedOption){b.target.addClass("selected");this.selectedOption=b.target;this.structure.firstChild.innerHTML=b.target.innerHTML;for(var a=0;a<this.referredSelect.options.length;a++){if(b.target.innerHTML===this.referredSelect.options[a].innerHTML){this.referredSelect.options[a].selected=true;break}}}else{if(this.selectedOption===b.target){b.target.removeClass("selected");this.selectedOption=null;this.structure.firstChild.innerHTML="Seleziona un'opzione";for(var a=0;a<this.referredSelect.options.length;a++){if(b.target.innerHTML===this.referredSelect.options[a].innerHTML){this.referredSelect.options[a].selected=false;break}}}else{this.selectedOption.removeClass("selected");for(var a=0;a<this.referredSelect.options.length;a++){if(this.selectedOption.innerHTML===this.referredSelect.options[a].innerHTML){this.referredSelect.options[a].selected=false}else{if(b.target.innerHTML===this.referredSelect.options[a].innerHTML){this.referredSelect.options[a].selected=true}}}b.target.addClass("selected");this.selectedOption=b.target;this.structure.firstChild.innerHTML=b.target.innerHTML}}}};MySingleSelect.constructor=MySingleSelect;var MyMultipleSelect=function(a){this.referredSelect=a;this.referredSelect.options=this.referredSelect.querySelectorAll("option");this.create()};MyMultipleSelect.prototype={structure:null,selectedElements:[],create:function(){var e;var d;var a;this.structure=document.createElement("div");this.structure.addClass("myFormSelect");e=document.createElement("span");e.innerHTML="Seleziona un'opzione";e.addEventListener("click",this.openSelect.bind(this));this.structure.appendChild(e);d=document.createElement("ul");this.structure.appendChild(d);var b=this.referredSelect.querySelectorAll("option");for(var c=0;c<b.length;c++){a=document.createElement("li");a.innerHTML=b[c].innerHTML;d.appendChild(a);a.addEventListener("click",this.optionSelected.bind(this))}document.addEventListener("click",this.closeSelect.bind(this))},openSelect:function(a){this.structure.toggleClass("showOptions")},closeSelect:function(a){if(a.target!==this.structure&&!this.structure.contains(a.target)){this.structure.removeClass("showOptions")}},optionSelected:function(b){if(this.selectedElements.indexOf(b.target)===-1){this.selectedElements.push(b.target);for(var a=0;a<this.referredSelect.options.length;a++){if(b.target.innerHTML===this.referredSelect.options[a].innerHTML){this.referredSelect.options[a].selected=true;break}}}else{this.selectedElements.splice(this.selectedElements.indexOf(b.target),1);for(var a=0;a<this.referredSelect.options.length;a++){if(b.target.innerHTML===this.referredSelect.options[a].innerHTML){this.referredSelect.options[a].selected=false;break}}}b.target.toggleClass("selected");switch(this.selectedElements.length){case 0:this.structure.firstChild.innerHTML="Seleziona un'opzione";break;case 1:this.structure.firstChild.innerHTML=this.selectedElements[0].innerHTML;break;default:this.structure.firstChild.innerHTML=this.selectedElements.length+" elementi selezionati"}}};MyMultipleSelect.constructor=MyMultipleSelect;window.addEventListener("load",function(d){var c=document.querySelectorAll(".myForm select");var a;for(var b=0;b<c.length;b++){if(c[b].hasAttribute("multiple")){a=new MyMultipleSelect(c[b])}else{a=new MySingleSelect(c[b])}c[b].parentNode.insertBefore(a.structure,c[b])}});var MyInputFile=function(a){this.referredInputFile=a;this.create()};MyInputFile.prototype={structure:null,create:function(){var a;this.structure=document.createElement("div");this.structure.addClass("myFormInputFile");a=document.createElement("button");a.setAttribute("type","button");a.appendChild(document.createTextNode("Sfoglia..."));this.structure.appendChild(a);a=document.createElement("span");a.addClass("myFormSelectedFile");a.appendChild(document.createTextNode("Seleziona il file..."));this.structure.appendChild(a);this.structure.addEventListener("click",this.onClick.bind(this));this.referredInputFile.addEventListener("change",this.fileSelected.bind(this))},onClick:function(a){this.referredInputFile.click()},fileSelected:function(a){if(a.target.files.length>0){this.structure.lastChild.innerHTML=a.target.files[0].name}else{this.structure.lastChild.innerHTML="Seleziona il file..."}}};window.addEventListener("load",function(d){var c=document.querySelectorAll(".myForm input[type='file']");var b;for(var a=0;a<c.length;a++){b=new MyInputFile(c[a]);c[a].parentNode.insertBefore(b.structure,c[a])}});var MyTimePicker=(function(){var a;var j;var b;var g;var m;var n;var i;var f;function e(){var o=document.createElement("div");o.setAttribute("id","hours");b=document.createElement("span");b.appendChild(document.createTextNode("˄"));o.appendChild(b);g=document.createElement("p");o.appendChild(g);m=document.createElement("span");m.appendChild(document.createTextNode("˅"));o.appendChild(m);return o}function d(){var o=document.createElement("div");o.setAttribute("id","minutes");n=document.createElement("span");n.appendChild(document.createTextNode("˄"));o.appendChild(n);i=document.createElement("p");o.appendChild(i);f=document.createElement("span");f.appendChild(document.createTextNode("˅"));o.appendChild(f);return o}function l(){j=document.createElement("div");j.setAttribute("id","myTimePicker");j.appendChild(e());j.appendChild(d());return j}function h(o,p){g.val=o;g.val<=9?g.innerHTML="0"+g.val:g.innerHTML=g.val;i.val=p;i.val<=9?i.innerHTML="0"+i.val:i.innerHTML=i.val;a.value=g.innerHTML+":"+i.innerHTML}function k(){document.addEventListener("click",function(q){if(q.target!==j&&!j.contains(q.target)&&a.parentNode.hasChild(j)){a.parentNode.removeChild(j);q.stopPropagation()}else{if(q.target===a&&!a.parentNode.hasChild(j)){if(a.value&&new RegExp("([01][0-9]|2[0-3]):([0-5][0-9])").test(a.value)){var p=a.value.split(":");h(parseInt(p[0]),parseInt(p[1]))}else{var o=new Date();h(o.getHours(),o.getMinutes())}j.removeAttribute("class");if(a.hasAttribute("data-animate")){j.addClass("animated");j.addClass(a.getAttribute("data-animate"))}a.parentNode.appendChild(j);q.stopPropagation()}}});b.addEventListener("click",function(o){if(g.val>=23){h(0,i.val)}else{h(g.val+1,i.val)}o.stopPropagation()});b.onselectstart=function(){return false};b.onmousedown=function(){return false};m.addEventListener("click",function(o){if(g.val<=0){h(23,i.val)}else{h(g.val-1,i.val)}o.stopPropagation()});m.onselectstart=function(){return false};m.onmousedown=function(){return false};n.addEventListener("click",function(o){if(i.val>=59){h(g.val,0)}else{h(g.val,i.val+1)}o.stopPropagation()});n.onselectstart=function(){return false};n.onmousedown=function(){return false};f.addEventListener("click",function(o){if(i.val<=0){h(g.val,59)}else{h(g.val,i.val-1)}o.stopPropagation()});f.onselectstart=function(){return false};f.onmousedown=function(){return false}}function c(){l();k();return j}return function(o){a=o.target;if(!j){console.log("createMyTimePicker()");c()}return j}})();window.addEventListener("load",function(){var b=document.querySelectorAll(".myTimePickerInput");for(var a=0;a<b.length;a++){b[a].addEventListener("click",MyTimePicker)}});var MyDatePicker=(function(){var o;var b;var k;var r;var g;var p;var a;var j;function e(){var t;var u;var s;u=document.createElement("tr");p=document.createElement("th");p.setAttribute("id","previousMonth");s=document.createElement("span");s.appendChild(document.createTextNode("«"));p.appendChild(s);u.appendChild(p);t=document.createElement("th");t.setAttribute("id","monthAndYear");t.setAttribute("colspan","5");r=document.createElement("span");r.setAttribute("id","month");t.appendChild(r);k=document.createElement("span");k.setAttribute("id","year");t.appendChild(k);u.appendChild(t);a=document.createElement("th");a.setAttribute("id","nextMonth");s=document.createElement("span");s.appendChild(document.createTextNode("»"));a.appendChild(s);u.appendChild(a);return u}function n(){var u=document.createElement("tr");var v=["Lu","Ma","Me","Gi","Ve","Sa","Do"];var t;for(var s in v){t=document.createElement("th");t.addClass("dayOfWeek");t.appendChild(document.createTextNode(v[s]));u.appendChild(t)}return u}function i(){var s=document.createElement("thead");s.appendChild(e());s.appendChild(n());return s}function m(){var s=document.createElement("tbody");var u;g=[];for(var t=0;t<42;t++){if((t%7)===0){if(t!==0){s.appendChild(u)}u=document.createElement("tr")}g[t]=document.createElement("td");g[t].addClass("day");u.appendChild(g[t])}s.appendChild(u);return s}function h(){b=document.createElement("div");b.setAttribute("id","myDatePicker");var s=document.createElement("table");s.appendChild(i());s.appendChild(m());b.appendChild(s);return b}function c(s){switch(s){case 0:return"Gennaio";case 1:return"Febbraio";case 2:return"Marzo";case 3:return"Aprile";case 4:return"Maggio";case 5:return"Giugno";case 6:return"Luglio";case 7:return"Agosto";case 8:return"Settembre";case 9:return"Ottobre";case 10:return"Novembre";case 11:return"Dicembre"}}function q(v,s){r.val=v;r.innerHTML=c(r.val);k.val=s;k.innerHTML=k.val;var u=new Date(k.val,r.val,1);for(var t=0;t<g.length;t++){g[t].setAttribute("class","day");g[t].val=new Date(u.getTime()-(((u.getDay()===0?6:u.getDay()-1)-t)*24*60*60*1000));g[t].innerHTML=g[t].val.getDate();if(g[t].val.getMonth()<r.val){g[t].addClass("oldMonthDay")}else{if(g[t].val.getMonth()>r.val){g[t].addClass("newMonthDay")}}if(j.getDate()===g[t].val.getDate()&&j.getMonth()===g[t].val.getMonth()&&j.getFullYear()===g[t].val.getFullYear()){g[t].addClass("activeDate")}}}function f(s){var u=s.getDate()<10?"0"+s.getDate():s.getDate();var t=s.getMonth()<9?"0"+(s.getMonth()+1):(s.getMonth()+1);o.value=u+"/"+t+"/"+s.getFullYear()}function d(){document.addEventListener("click",function(v){if(v.target!==b&&!b.contains(v.target)&&o.parentNode.hasChild(b)){o.parentNode.removeChild(b);v.stopPropagation()}else{if(v.target===o&&!o.parentNode.hasChild(b)){if(o.value&&new RegExp("(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[0-2])/([0-9]{4})").test(o.value)){var u=o.value.split("/");j=new Date(u[1]+"/"+u[0]+"/"+u[2])}else{j=new Date()}q(j.getMonth(),j.getFullYear());f(j);b.removeAttribute("class");if(o.hasAttribute("data-animate")){b.addClass("animated");b.addClass(o.getAttribute("data-animate"))}o.parentNode.appendChild(b);v.stopPropagation()}}});p.addEventListener("click",function(u){r.val==0?q(11,(k.val-1)):q((r.val-1),k.val);u.stopPropagation()});p.onselectstart=function(){return false};p.onmousedown=function(){return false};a.addEventListener("click",function(u){r.val==11?q(0,(k.val+1)):q((r.val+1),k.val);u.stopPropagation()});a.onselectstart=function(){return false};a.onmousedown=function(){return false};var t=function(v){for(var u=0;u<g.length;u++){if(g[u].val.getDate()===j.getDate()&&g[u].val.getMonth()===j.getMonth()&&g[u].val.getFullYear()===j.getFullYear()){g[u].removeClass("activeDate")}}j=this.val;this.addClass("activeDate");f(j);v.stopPropagation()};for(var s=0;s<g.length;s++){g[s].addEventListener("click",t);g[s].onselectstart=function(){return false};g[s].onmousedown=function(){return false}}}function l(){h();d();return b}return function(s){o=this;if(!b){l()}return b}})();window.addEventListener("load",function(){var b=document.querySelectorAll(".myDatePickerInput");for(var a=0;a<b.length;a++){b[a].addEventListener("click",MyDatePicker)}});